---
layout: base.njk
title: "Reservas y contacto"
description: "Solicita disponibilidad para Casa Bardena Negra o reserva desde Rurive."
permalink: "/reservas/"
---

<section class="container prose">
  <div class="card">
    <h1>Solicitar disponibilidad</h1>

    <form name="reserva"
      method="POST"
      action="/gracias/"
      data-netlify="true"
      netlify-honeypot="bot-field"
      accept-charset="UTF-8">

      <input type="hidden" name="form-name" value="reserva">

      <!-- Honeypot (no borrar) -->
      <p class="sr-only" aria-hidden="true">
        <label>Si ves este campo, déjalo vacío
          <input type="text" name="bot-field" tabindex="-1" autocomplete="off">
        </label>
      </p>

      <div class="grid cols-2">
        <p class="field">
          <label for="name">Nombre</label>
          <input required id="name" name="name" type="text" placeholder="Tu nombre" autocomplete="name">
        </p>
        <p class="field">
          <label for="email">Email</label>
          <input required id="email" name="email" type="email" placeholder="tucorreo@ejemplo.com" autocomplete="email" inputmode="email">
        </p>
      </div>

      <div class="grid cols-2">
        <p class="field">
          <label for="checkin">Entrada</label>
          <input required id="checkin" name="checkin" type="date">
          <span class="help">Elige día de llegada</span>
        </p>
        <p class="field">
          <label for="checkout">Salida</label>
          <input required id="checkout" name="checkout" type="date">
          <span class="help">Noches: <strong id="nights">—</strong></span>
        </p>
      </div>

      <div class="grid cols-3">
        <p class="field">
          <label for="adultos">Adultos</label>
          <input id="adultos" name="adultos" type="number" min="1" value="2" inputmode="numeric">
        </p>
        <p class="field">
          <label for="ninos">Niños</label>
          <input id="ninos" name="ninos" type="number" min="0" value="0" inputmode="numeric">
        </p>
        <p class="field">
          <label for="telefono">Teléfono (opcional)</label>
          <input id="telefono" name="telefono" type="tel" autocomplete="tel" inputmode="tel" pattern="^[0-9+()\\s-]{7,}$">
          <span class="help">Para avisos de última hora</span>
        </p>
      </div>

      <p class="field">
        <label for="mensaje">Mensaje (opcional)</label>
        <textarea id="mensaje" name="mensaje" rows="4" placeholder="Cuéntanos detalles de tu estancia o dudas"></textarea>
      </p>

      <p class="inline">
        <input id="privacy" type="checkbox" required>
        <label for="privacy">He leído y acepto la <a href="/privacidad/">política de privacidad</a>.</label>
      </p>

      <!-- reCAPTCHA de Netlify -->
      <div data-netlify-recaptcha="true"></div>

      <p><button class="btn" type="submit">Enviar consulta</button></p>
    </form>
  </div>

  <div class="card">
    <h2>¿Prefieres reservar ya?</h2>
    <p>Puedes hacerlo directamente desde Rurive:</p>
    <p><a class="btn" href="{{ site.bookingHref }}" target="_blank" rel="noopener">Ir a Rurive</a></p>

    <h3>Familias</h3>
    <ul>
      <li>Bienvenidos bebés y niños. Cuna disponible bajo petición.</li>
      <li>Capacidad estándar: 8 personas (opción +2 en sofá cama).</li>
      <li>Indica edades para preparar la casa (trona, cuna...).</li>
    </ul>
  </div>
</section>

<script>
  // ===== Validación útil: fechas y noches =====
  const $in  = document.getElementById("checkin");
  const $out = document.getElementById("checkout");
  const $n   = document.getElementById("nights");

  const today = new Date(); today.setHours(0,0,0,0);
  const iso = d => d.toISOString().slice(0,10);

  $in.min = iso(today);

  function nextDay(d){ const x = new Date(d); x.setDate(x.getDate()+1); return x }
  function toDate(v){ const d = new Date(v); return isNaN(d) ? null : d }

  function updateLimits(){
    const di = toDate($in.value);
    if (di){
      $out.min = iso(nextDay(di));
      if ($out.value && toDate($out.value) <= di) $out.value = "";
    }
    updateNights();
  }

  function updateNights(){
    const di = toDate($in.value), doo = toDate($out.value);
    $out.setCustomValidity("");
    if (di && doo){
      const nights = Math.round((doo - di) / 86400000);
      if (nights <= 0){
        $out.setCustomValidity("La salida debe ser posterior a la entrada.");
      }
      $n.textContent = nights > 0 ? nights : "—";
    } else {
      $n.textContent = "—";
    }
  }

  $in.addEventListener("change", updateLimits);
  $out.addEventListener("change", updateNights);
  updateLimits();
</script>
